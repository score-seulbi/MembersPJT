# Time Series ARIMA

# install.packages('TTR')
# install.packages('forecast')
library(TTR)
library(forecast)
library(plyr)
library(dplyr)



# registration

# new members
# new sa id
# restration


nm = readClipboard() %>% as.integer()
sa = readClipboard() %>% as.integer()
rs = readClipboard() %>% as.integer()

# ts data
ts_nm = ts(nm)
ts_sa = ts(sa)
ts_rs = ts(rs)

df <- data.frame(nm = nm, sa = sa, rs = rs)

model = lm(nm ~ sa, data = df)
summary(model)


forecast(model)


beer2 <- window(ausbeer, start=1992)

fit.reg <- tslm(ts_nm ~ ts_sa + ts_rs)
fcast <- forecast(fit.reg, h = 5)

fit.beer <- tslm(beer2 ~ trend + season)
fcast <- forecast(fit.beer, )
autoplot(fcast) +
  ggtitle("회귀를 이용한 맥주 생산량 예측값") +
  xlab("연도") + ylab("백만 리터")




# New Members
1429385
1238612
1075418
1112060
1238563
2127381
1835153
2041917
1963771
1958506
1970844
2643914
2279121
2330825
2713613
2449359
2572564
2364583
2057653
2040298
2063881
2271977
2093983
3014248
2774390
2984398
2648471
3331802
3517966
3354483
3849870
3194186
3556860
3378654
3267108
3756563
3637178
3793661
3467200
3533811
5133269
4117163
3958477
3529420
4056840
3901197
3590522
4248844
3473497
3510364
3987439
3628957
3567454
3413655

# New SA ID
9042655
10599309
10312739
11228225
11227215
10965192
11324748
11813077
12511005
12312883
10835029
12204064
11120121
11563314
11407464
11290382
12167243
11453618
11448967
12606539
13629821
12015836
10725904
13400742
12534469
14221446
14597683
15055641
15618916
15026251
15302324
15935050
19190819
16701649
14844697
15907192
14961960
15538562
14697067
14407959
14978195
14896041
14937043
15279980
17590605
15637981
13390964
14472199
13327833
14285152
13997148
14015139
14349948
13404876


# Registration
0.158071385
0.116857806
0.104280541
0.099041478
0.110317919
0.194012198
0.162048021
0.172852255
0.156963489
0.159061529
0.181895591
0.216642096
0.204954694
0.201570674
0.237880479
0.216942084
0.211433601
0.206448565
0.1797239
0.161844421
0.151423926
0.189081892
0.195226715
0.224931425
0.221340848
0.209851938
0.181430916
0.221299246
0.225237526
0.223241512
0.251587275
0.200450328
0.185341751
0.202294636
0.220085866
0.236155005
0.243095022
0.244144922
0.235911015
0.24526798
0.342716128
0.276393103
0.265010752
0.230983287
0.230625382
0.249469353
0.268130211
0.293586621
0.260619787
0.245735152
0.284875105
0.258931217
0.248603967
0.254657708

